"0","# 1. List all CSV files in the folder"
"0","files <- list.files("
"0","  path = ""/scratch/ope4/BIO_599/dendrometers/"","
"0","  pattern = ""_data_.*\\.csv$"","
"0","  full.names = TRUE"
"0",")"
"0",""
"0","# 2. Function to read a file and add dendro_number"
"0","read_dendro_file <- function(file) {"
"0","  # Read the CSV"
"0","  sub <- read.csv(file, sep = "";"", header = FALSE, stringsAsFactors = FALSE)"
"0","  "
"0","  # Extract dendro number from filename"
"0","  dendro_number <- as.numeric(gsub("".*_data_([0-9]+)_.*"", ""\\1"", file))"
"0","  "
"0","  # Add column"
"0","  sub$Dendro_number <- dendro_number"
"0","  "
"0","  return(sub)"
"0","}"
"0",""
"0","# 3. Apply to all files and combine into one data frame"
"0","all_data <- lapply(files, read_dendro_file) %>% bind_rows()"
"0",""
"0","# select col of interest"
"0","combined_data <- all_data |>"
"0","  select(Dendro_number, V2, V4, V7) |>"
"0","  filter(V7 != 0) "
"0",""
"0",""
"0","##rename the cols"
"0","colnames(combined_data) <- c(""Dendro_number"", ""DateTime"", ""Temp"", ""dendro"")"
"0",""
"0","summary(combined_data)"
"1",""
"1"," Dendro_number     "
"1","   DateTime        "
"1","      Temp       "
"1","     dendro    "
"1","
"
"1"," Min.   :92240313  "
"1"," Length:2633911    "
"1"," Min.   :-22.38  "
"1"," Min.   :   1  "
"1","
"
"1"," 1st Qu.:92240360  "
"1"," Class :character  "
"1"," 1st Qu.:  3.25  "
"1"," 1st Qu.: 541  "
"1","
"
"1"," Median :92246647  "
"1"," Mode  :character  "
"1"," Median : 12.38  "
"1"," Median :1076  "
"1","
"
"1"," Mean   :92243787  "
"1","                   "
"1"," Mean   : 12.07  "
"1"," Mean   :1539  "
"1","
"
"1"," 3rd Qu.:92246667  "
"1","                   "
"1"," 3rd Qu.: 20.38  "
"1"," 3rd Qu.:1885  "
"1","
"
"1"," Max.   :92248330  "
"1","                   "
"1"," Max.   : 45.81  "
"1"," Max.   :8890  "
"1","
"
"0","# Convert DateTime to POSIXct if not already"
"0","combined_data$DateTime <- as.POSIXct(combined_data$DateTime, format = ""%Y.%m.%d %H:%M"")"
"0","combined_data$Temp <- as.numeric(combined_data$Temp)  # safe if it's already numeric"
"0","combined_data$Dendro_number <- as.numeric(combined_data$Dendro_number)  # safe if it's already numeric"
"0","str(combined_data)"
"1","'data.frame':	"
"1",""
"1","2633911"
"1",""
"1"," obs. of  "
"1",""
"1","4"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Dendro_number"
"1",""
"1",":"
"1"," num  "
"1",""
"1","92246682 92246682 92246682 92246682 92246682"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","DateTime     "
"1",""
"1",":"
"1"," "
"1",""
"1","POSIXct"
"1",""
"1",", format: "
"1",""
"1","""2024-07-31 22:30:00"" ""2024-07-31 22:45:00"" ""2024-07-31 23:00:00"" ""2024-07-31 23:15:00"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Temp         "
"1",""
"1",":"
"1"," num  "
"1",""
"1","24.1 21.7 20.2 15.8 13.9"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","dendro       "
"1",""
"1",":"
"1"," int  "
"1",""
"1","963 963 962 958 957 956 956 956 956 955"
"1",""
"1"," ..."
"1",""
"1","
"
"0","head(combined_data$DateTime, 20)"
"1"," [1]"
"1"," ""2024-07-31 22:30:00 MST"""
"1"," ""2024-07-31 22:45:00 MST"""
"1"," ""2024-07-31 23:00:00 MST"""
"1"," ""2024-07-31 23:15:00 MST"""
"1","
"
"1"," [5]"
"1"," ""2024-07-31 23:30:00 MST"""
"1"," ""2024-07-31 23:45:00 MST"""
"1"," ""2024-08-01 00:00:00 MST"""
"1"," ""2024-08-01 00:15:00 MST"""
"1","
"
"1"," [9]"
"1"," ""2024-08-01 00:30:00 MST"""
"1"," ""2024-08-01 00:45:00 MST"""
"1"," ""2024-08-01 01:00:00 MST"""
"1"," ""2024-08-01 01:15:00 MST"""
"1","
"
"1","[13]"
"1"," ""2024-08-01 01:30:00 MST"""
"1"," ""2024-08-01 01:45:00 MST"""
"1"," ""2024-08-01 02:00:00 MST"""
"1"," ""2024-08-01 02:15:00 MST"""
"1","
"
"1","[17]"
"1"," ""2024-08-01 02:30:00 MST"""
"1"," ""2024-08-01 02:45:00 MST"""
"1"," ""2024-08-01 03:00:00 MST"""
"1"," ""2024-08-01 03:15:00 MST"""
"1","
"
"0","# 1. Compute the maximum per dendrometer across all time"
"0","dendro_max <- combined_data %>%"
"0","  group_by(Dendro_number) %>%"
"0","  summarise(dmax = max(dendro, na.rm = TRUE), .groups = 'drop')"
"0",""
"0","# 2. Join dmax and calculate TWD for each measurement"
"0","combined_data <- combined_data %>%"
"0","  left_join(dendro_max, by = ""Dendro_number"") %>%"
"0","  mutate(TWD = dmax - dendro)  # TWD for each 15-min measurement"
"0",""
"0","daily_variation <- combined_data %>%"
"0","  mutate(Date = as.Date(DateTime)) %>%       # add date-only column"
"0","  group_by(Dendro_number, Date) %>%         # group by dendrometer and day"
"0","  summarise("
"0","   min_dendro = min(dendro, na.rm = TRUE),"
"0","    max_dendro = max(dendro, na.rm = TRUE),"
"0","    DV = max_dendro - min_dendro,"
"0","    TWD = mean(TWD, na.rm = TRUE),"
"0","   min_temp = min(Temp, na.rm = TRUE),"
"0","   max_temp = max(Temp, na.rm = TRUE),"
"0","   temp_range = max_temp - min_temp,"
"0","     ) %>%"
"0","  ungroup()"
"0",""
"0","summary(daily_variation)"
"1",""
"1"," Dendro_number     "
"1","      Date           "
"1","   min_dendro  "
"1","   max_dendro  "
"1","       DV         "
"1","      TWD        "
"1","    min_temp      "
"1","
"
"1"," Min.   :92240313  "
"1"," Min.   :2023-09-22  "
"1"," Min.   :   1  "
"1"," Min.   :   1  "
"1"," Min.   :   0.00  "
"1"," Min.   :   0.0  "
"1"," Min.   :-22.375  "
"1","
"
"1"," 1st Qu.:92240362  "
"1"," 1st Qu.:2024-09-14  "
"1"," 1st Qu.: 546  "
"1"," 1st Qu.: 552  "
"1"," 1st Qu.:   2.00  "
"1"," 1st Qu.: 237.6  "
"1"," 1st Qu.: -2.250  "
"1","
"
"1"," Median :92246649  "
"1"," Median :2025-01-08  "
"1"," Median :1082  "
"1"," Median :1095  "
"1"," Median :   6.00  "
"1"," Median : 695.2  "
"1"," Median :  5.375  "
"1","
"
"1"," Mean   :92244100  "
"1"," Mean   :2024-12-29  "
"1"," Mean   :1543  "
"1"," Mean   :1560  "
"1"," Mean   :  17.29  "
"1"," Mean   :1018.5  "
"1"," Mean   :  5.267  "
"1","
"
"1"," 3rd Qu.:92246669  "
"1"," 3rd Qu.:2025-05-05  "
"1"," 3rd Qu.:1836  "
"1"," 3rd Qu.:1863  "
"1"," 3rd Qu.:  13.00  "
"1"," 3rd Qu.:1565.9  "
"1"," 3rd Qu.: 12.750  "
"1","
"
"1"," Max.   :92248330  "
"1"," Max.   :2025-08-13  "
"1"," Max.   :8890  "
"1"," Max.   :8890  "
"1"," Max.   :7828.00  "
"1"," Max.   :7794.3  "
"1"," Max.   : 36.000  "
"1","
"
"1",""
"1","    max_temp    "
"1","   temp_range   "
"1","
"
"1"," Min.   :-7.25  "
"1"," Min.   : 0.00  "
"1","
"
"1"," 1st Qu.:12.50  "
"1"," 1st Qu.:12.19  "
"1","
"
"1"," Median :22.25  "
"1"," Median :16.06  "
"1","
"
"1"," Mean   :21.00  "
"1"," Mean   :15.73  "
"1","
"
"1"," 3rd Qu.:29.12  "
"1"," 3rd Qu.:19.62  "
"1","
"
"1"," Max.   :45.81  "
"1"," Max.   :35.25  "
"1","
"
"0","length(unique(combined_data$Dendro_number))"
"1","[1]"
"1"," 79"
"1","
"
"0","length(unique(daily_variation$Dendro_number))"
"1","[1]"
"1"," 79"
"1","
"

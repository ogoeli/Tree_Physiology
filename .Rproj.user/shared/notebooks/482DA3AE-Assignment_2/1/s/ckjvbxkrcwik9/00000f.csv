"0","    merged <- reduce(list(soil_clipped, evapo_clipped, precip_clipped), left_join, by = c(""Dendro_number"", ""Date""))"
"0",""
"0","    colnames(merged)"
"1","[1]"
"1"," ""Dendro_number""     "
"1"," ""Date""              "
"1"," ""soil_moisture_am""  "
"1"," ""evapotranspiration"""
"1"," ""precipitation""     "
"1","
"
"0","    # Step 3: Merge"
"0","    merged_data <- daily_variation %>%"
"0","      left_join(merged, by = c(""Dendro_number"", ""Date""))"
"0",""
"0",""
"0","    ##step 4: test for trend in daily variation of dendrometer"
"0","    check_trend <- function(x, alpha = 0.05) {"
"0","      # Drop NAs"
"0","      x <- x[!is.na(x)]"
"0","      "
"0","      # Require at least 14 points for decompose (2 periods if freq=7)"
"0","      if (length(x) < 14) {"
"0","        return(""not enough data"")"
"0","      }"
"0","      "
"0","      # Turn into time series"
"0","      ts <- ts(x, frequency = 7)"
"0","      "
"0","      # Perform additive decomposition"
"0","      decomp_add <- decompose(ts, type = ""additive"")"
"0","      "
"0","      # Use the trend component (remove NAs first)"
"0","      trend_vals <- decomp_add$trend"
"0","      trend_vals <- trend_vals[!is.na(trend_vals)]"
"0","      "
"0","      if (length(trend_vals) < 3) {"
"0","        return(""not enough trend data"")"
"0","      }"
"0","      "
"0","      mk <- trend::mk.test(trend_vals)"
"0","      sen <- trend::sens.slope(trend_vals)"
"0","      "
"0","      if (mk$p.value < alpha) {"
"0","        if (sen$estimates > 0) {"
"0","          return(""increasing"")"
"0","        } else if (sen$estimates < 0) {"
"0","          return(""decreasing"")"
"0","        }"
"0","      }"
"0","      return(""stable"")"
"0","    }"
"0",""
"0",""
"0","    trend_results <- merged_data %>%"
"0","      group_by(Dendro_number) %>%"
"0","      summarise(Trend = check_trend(DV), .groups = ""drop"")"
"0",""
"0","    table(trend_results$Trend)"
"1","
"
"1","     decreasing "
"1","     increasing "
"1","not enough data "
"1","         stable "
"1","
"
"1","             26 "
"1","             33 "
"1","              1 "
"1","             19 "
"1","
"
"0","    trend_all <- merged_data %>%"
"0","      left_join(trend_results, by = ""Dendro_number"") %>%"
"0","      mutate(Trend = Trend)  # TWD for each 15-min measurement"
"0",""
"0",""
"0",""

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ogonna Eli">

<title>Assignment_2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment_2_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment_2_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment_2_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment_2_files/libs/bootstrap/bootstrap-b6d0922162485bd387ca556e6d9a875d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment_2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ogonna Eli </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="load-the-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-the-packages">Load the packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.libPaths</span>(<span class="fu">c</span>(<span class="st">"/home/ope4/R/4.4.0"</span>, <span class="fu">.libPaths</span>()))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.12.1, GDAL 3.8.5, PROJ 6.3.2; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Kendall)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(trend)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>lattice theme set by effectsTheme()
See ?effectsTheme for details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(flextable)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#library(see)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(webshot2)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("systemfonts")</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   4.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::%||%()        masks base::%||%()
✖ dplyr::collapse()    masks nlme::collapse()
✖ tidyr::expand()      masks Matrix::expand()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::lag()         masks stats::lag()
✖ tidyr::pack()        masks Matrix::pack()
✖ dplyr::select()      masks MASS::select()
✖ ggplot2::set_theme() masks sjPlot::set_theme()
✖ tidyr::unpack()      masks Matrix::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="fit-a-linear-or-mixed-effects-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-a-linear-or-mixed-effects-model">Fit a Linear or Mixed-Effects Model&nbsp;</h2>
<ol type="1">
<li>Data cleaning and processing</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. List all CSV files in the folder</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"/scratch/ope4/BIO_599/dendrometers/"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="st">"_data_.*</span><span class="sc">\\</span><span class="st">.csv$"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Function to read a file and add dendro_number</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>read_dendro_file <span class="ot">&lt;-</span> <span class="cf">function</span>(file) {</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read the CSV</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file, <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract dendro number from filename</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  dendro_number <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">".*_data_([0-9]+)_.*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, file))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add column</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>Dendro_number <span class="ot">&lt;-</span> dendro_number</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sub)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Apply to all files and combine into one data frame</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(files, read_dendro_file) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co"># select col of interest</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> all_data <span class="sc">|&gt;</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dendro_number, V2, V4, V7) <span class="sc">|&gt;</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(V7 <span class="sc">!=</span> <span class="dv">0</span>) </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="do">##rename the cols</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dendro_number"</span>, <span class="st">"DateTime"</span>, <span class="st">"Temp"</span>, <span class="st">"dendro"</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Dendro_number        DateTime              Temp            dendro    
 Min.   :92240313   Length:2633911     Min.   :-22.38   Min.   :   1  
 1st Qu.:92240360   Class :character   1st Qu.:  3.25   1st Qu.: 541  
 Median :92246647   Mode  :character   Median : 12.38   Median :1076  
 Mean   :92243787                      Mean   : 12.07   Mean   :1539  
 3rd Qu.:92246667                      3rd Qu.: 20.38   3rd Qu.:1885  
 Max.   :92248330                      Max.   : 45.81   Max.   :8890  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert DateTime to POSIXct if not already</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>DateTime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(combined_data<span class="sc">$</span>DateTime, <span class="at">format =</span> <span class="st">"%Y.%m.%d %H:%M"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>Temp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(combined_data<span class="sc">$</span>Temp)  <span class="co"># safe if it's already numeric</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>Dendro_number <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(combined_data<span class="sc">$</span>Dendro_number)  <span class="co"># safe if it's already numeric</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2633911 obs. of  4 variables:
 $ Dendro_number: num  92246682 92246682 92246682 92246682 92246682 ...
 $ DateTime     : POSIXct, format: "2024-07-31 22:30:00" "2024-07-31 22:45:00" ...
 $ Temp         : num  24.1 21.7 20.2 15.8 13.9 ...
 $ dendro       : int  963 963 962 958 957 956 956 956 956 955 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combined_data<span class="sc">$</span>DateTime, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2024-07-31 22:30:00 MST" "2024-07-31 22:45:00 MST"
 [3] "2024-07-31 23:00:00 MST" "2024-07-31 23:15:00 MST"
 [5] "2024-07-31 23:30:00 MST" "2024-07-31 23:45:00 MST"
 [7] "2024-08-01 00:00:00 MST" "2024-08-01 00:15:00 MST"
 [9] "2024-08-01 00:30:00 MST" "2024-08-01 00:45:00 MST"
[11] "2024-08-01 01:00:00 MST" "2024-08-01 01:15:00 MST"
[13] "2024-08-01 01:30:00 MST" "2024-08-01 01:45:00 MST"
[15] "2024-08-01 02:00:00 MST" "2024-08-01 02:15:00 MST"
[17] "2024-08-01 02:30:00 MST" "2024-08-01 02:45:00 MST"
[19] "2024-08-01 03:00:00 MST" "2024-08-01 03:15:00 MST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Compute the maximum per dendrometer across all time</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>dendro_max <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dendro_number) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">dmax =</span> <span class="fu">max</span>(dendro, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Join dmax and calculate TWD for each measurement</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dendro_max, <span class="at">by =</span> <span class="st">"Dendro_number"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TWD =</span> dmax <span class="sc">-</span> dendro)  <span class="co"># TWD for each 15-min measurement</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>daily_variation <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(DateTime)) <span class="sc">%&gt;%</span>       <span class="co"># add date-only column</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dendro_number, Date) <span class="sc">%&gt;%</span>         <span class="co"># group by dendrometer and day</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">min_dendro =</span> <span class="fu">min</span>(dendro, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_dendro =</span> <span class="fu">max</span>(dendro, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">DV =</span> max_dendro <span class="sc">-</span> min_dendro,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">TWD =</span> <span class="fu">mean</span>(TWD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>   <span class="at">min_temp =</span> <span class="fu">min</span>(Temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>   <span class="at">max_temp =</span> <span class="fu">max</span>(Temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>   <span class="at">temp_range =</span> max_temp <span class="sc">-</span> min_temp,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">%&gt;%</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Dendro_number'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(daily_variation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Dendro_number           Date              min_dendro     max_dendro  
 Min.   :92240313   Min.   :2023-09-22   Min.   :   1   Min.   :   1  
 1st Qu.:92240362   1st Qu.:2024-09-14   1st Qu.: 546   1st Qu.: 552  
 Median :92246649   Median :2025-01-08   Median :1082   Median :1095  
 Mean   :92244100   Mean   :2024-12-29   Mean   :1543   Mean   :1560  
 3rd Qu.:92246669   3rd Qu.:2025-05-05   3rd Qu.:1836   3rd Qu.:1863  
 Max.   :92248330   Max.   :2025-08-13   Max.   :8890   Max.   :8890  
       DV               TWD            min_temp          max_temp    
 Min.   :   0.00   Min.   :   0.0   Min.   :-22.375   Min.   :-7.25  
 1st Qu.:   2.00   1st Qu.: 237.6   1st Qu.: -2.250   1st Qu.:12.50  
 Median :   6.00   Median : 695.2   Median :  5.375   Median :22.25  
 Mean   :  17.29   Mean   :1018.5   Mean   :  5.267   Mean   :21.00  
 3rd Qu.:  13.00   3rd Qu.:1565.9   3rd Qu.: 12.750   3rd Qu.:29.12  
 Max.   :7828.00   Max.   :7794.3   Max.   : 36.000   Max.   :45.81  
   temp_range   
 Min.   : 0.00  
 1st Qu.:12.19  
 Median :16.06  
 Mean   :15.73  
 3rd Qu.:19.62  
 Max.   :35.25  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(combined_data<span class="sc">$</span>Dendro_number))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 79</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(daily_variation<span class="sc">$</span>Dendro_number))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 79</code></pre>
</div>
</div>
<ol type="1">
<li><p>Add environmental variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add the climate dataset</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>precip <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/scratch/ope4/BIO_599/Dendro Climate Points/precipitation_time_series.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 46208 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): system:index, Tree_nm, .geo
dbl  (2): Dndrmtr, precipitation
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(precip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> system:index          Dndrmtr           Tree_nm               date           
 Length:46208       Min.   :92240313   Length:46208       Min.   :2024-01-01  
 Class :character   1st Qu.:92240375   Class :character   1st Qu.:2024-05-31  
 Mode  :character   Median :92246668   Mode  :character   Median :2024-10-30  
                    Mean   :92337631                      Mean   :2024-10-30  
                    3rd Qu.:92248307                      3rd Qu.:2025-03-31  
                    Max.   :99246685                      Max.   :2025-08-30  
 precipitation          .geo          
 Min.   :  0.0000   Length:46208      
 1st Qu.:  0.0000   Class :character  
 Median :  0.0000   Mode  :character  
 Mean   : 10.2958                     
 3rd Qu.:  0.9043                     
 Max.   :441.8563                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(precip<span class="sc">$</span>Dndrmtr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Prepare precipitation (keep only relevant columns)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>precip_daily <span class="ot">&lt;-</span> precip <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dndrmtr, date, precipitation) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dendro_number =</span> Dndrmtr,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Date =</span> date)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find date range of dendrometer data</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">range</span>(daily_variation<span class="sc">$</span>Date, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip precip to fall within that range</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>precip_clipped <span class="ot">&lt;-</span> precip_daily <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> date_range[<span class="dv">1</span>] <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> date_range[<span class="dv">2</span>])</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="do">####evapo</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">#add the climate dataset</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>evapo <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/scratch/ope4/BIO_599/Dendro Climate Points/evapotranspiration_time_series.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5852 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): system:index, Tree_nm, .geo
dbl  (2): Dndrmtr, evapotranspiration
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(evapo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> system:index          Dndrmtr           Tree_nm               date           
 Length:5852        Min.   :92240313   Length:5852        Min.   :2024-01-01  
 Class :character   1st Qu.:92240375   Class :character   1st Qu.:2024-06-01  
 Mode  :character   Median :92246668   Mode  :character   Median :2024-10-31  
                    Mean   :92337631                      Mean   :2024-10-30  
                    3rd Qu.:92248307                      3rd Qu.:2025-03-30  
                    Max.   :99246685                      Max.   :2025-08-29  
 evapotranspiration     .geo          
 Min.   :  1.00     Length:5852       
 1st Qu.: 34.00     Class :character  
 Median : 48.00     Mode  :character  
 Mean   : 53.54                       
 3rd Qu.: 67.00                       
 Max.   :195.00                       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(evapo<span class="sc">$</span>Dndrmtr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">##interpolate to daily instead of every 8 days</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure date is Date type</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>evapo <span class="ot">&lt;-</span> evapo <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolate daily for each dendrometer</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>evapo_daily <span class="ot">&lt;-</span> evapo <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dndrmtr) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create full daily sequence for each dendrometer</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(<span class="at">date =</span> <span class="fu">seq</span>(<span class="fu">min</span>(date), <span class="fu">max</span>(date), <span class="at">by =</span> <span class="st">"1 day"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Interpolate evapotranspiration</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">evapotranspiration =</span> <span class="fu">na.approx</span>(evapotranspiration, <span class="at">x =</span> date, <span class="at">maxgap =</span> <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Prepare precipitation (keep only relevant columns)</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>evapo_daily <span class="ot">&lt;-</span> evapo_daily <span class="sc">%&gt;%</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dndrmtr, date, evapotranspiration) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dendro_number =</span> Dndrmtr,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Date =</span> date)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Find date range of dendrometer data</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">range</span>(daily_variation<span class="sc">$</span>Date, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip precip to fall within that range</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>evapo_clipped <span class="ot">&lt;-</span> evapo_daily <span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> date_range[<span class="dv">1</span>] <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> date_range[<span class="dv">2</span>])</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="do">#### soil moisture</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="co">#add the climate dataset</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>soil <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/scratch/ope4/BIO_599/Dendro Climate Points/soil_moisture_time_series.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 45980 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): system:index, Tree_nm, .geo
dbl  (2): Dndrmtr, soil_moisture_am
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(soil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> system:index          Dndrmtr           Tree_nm               date           
 Length:45980       Min.   :92240313   Length:45980       Min.   :2024-01-03  
 Class :character   1st Qu.:92240375   Class :character   1st Qu.:2024-06-02  
 Mode  :character   Median :92246668   Mode  :character   Median :2024-10-31  
                    Mean   :92337631                      Mean   :2024-10-31  
                    3rd Qu.:92248307                      3rd Qu.:2025-04-01  
                    Max.   :99246685                      Max.   :2025-08-30  

 soil_moisture_am     .geo          
 Min.   :0.039    Length:45980      
 1st Qu.:0.089    Class :character  
 Median :0.115    Mode  :character  
 Mean   :0.130                      
 3rd Qu.:0.157                      
 Max.   :0.434                      
 NA's   :25423                      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(soil<span class="sc">$</span>Dndrmtr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Prepare precipitation (keep only relevant columns)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>soil <span class="ot">&lt;-</span> soil <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dndrmtr, date, soil_moisture_am) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dendro_number =</span> Dndrmtr,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Date =</span> date)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find date range of dendrometer data</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">range</span>(daily_variation<span class="sc">$</span>Date, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip precip to fall within that range</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>soil_clipped <span class="ot">&lt;-</span> soil <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> date_range[<span class="dv">1</span>] <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> date_range[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Merge the environmental variables to the main dendrometer data set and detrend your time series dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">reduce</span>(<span class="fu">list</span>(soil_clipped, evapo_clipped, precip_clipped), left_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Dendro_number"</span>, <span class="st">"Date"</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Dendro_number"      "Date"               "soil_moisture_am"  
[4] "evapotranspiration" "precipitation"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Merge</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> daily_variation <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(merged, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Dendro_number"</span>, <span class="st">"Date"</span>))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 4: test for trend in daily variation of dendrometer</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>check_trend <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop NAs</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Require at least 14 points for decompose (2 periods if freq=7)</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;</span> <span class="dv">14</span>) {</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Trend =</span> <span class="st">"not enough data"</span>, <span class="at">Slope =</span> <span class="cn">NA</span>))</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Turn into time series</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(x, <span class="at">frequency =</span> <span class="dv">7</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform additive decomposition</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  decomp_add <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts, <span class="at">type =</span> <span class="st">"additive"</span>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the trend component (remove NAs first)</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  trend_vals <span class="ot">&lt;-</span> decomp_add<span class="sc">$</span>trend</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  trend_vals <span class="ot">&lt;-</span> trend_vals[<span class="sc">!</span><span class="fu">is.na</span>(trend_vals)]</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(trend_vals) <span class="sc">&lt;</span> <span class="dv">3</span>) {</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Trend =</span> <span class="st">"not enough trend data"</span>, <span class="at">Slope =</span> <span class="cn">NA</span>))</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  mk <span class="ot">&lt;-</span> trend<span class="sc">::</span><span class="fu">mk.test</span>(trend_vals)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  sen <span class="ot">&lt;-</span> trend<span class="sc">::</span><span class="fu">sens.slope</span>(trend_vals)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> sen<span class="sc">$</span>estimates</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine trend direction</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (mk<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (slope <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Trend =</span> <span class="st">"increasing"</span>, <span class="at">Slope =</span> slope))</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (slope <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Trend =</span> <span class="st">"decreasing"</span>, <span class="at">Slope =</span> slope))</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Trend =</span> <span class="st">"stable"</span>, <span class="at">Slope =</span> slope))</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="do">## Apply by Dendro_number</span></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>trend_results <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dendro_number) <span class="sc">%&gt;%</span></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmp =</span> <span class="fu">list</span>(<span class="fu">check_trend</span>(TWD)),</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(tmp)  <span class="co"># expands Trend and Slope into separate columns</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(trend_results<span class="sc">$</span>Trend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     decreasing      increasing not enough data          stable 
             36              33               1               9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Merge back with main data</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>trend_all <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(trend_results, <span class="at">by =</span> <span class="st">"Dendro_number"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trend =</span> Trend)  <span class="co"># keep trend label for each record</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>functional mechanism for tree water deficit</p>
<ul>
<li>perform EDA and run a model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>summer_2025 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/scratch/ope4/BIO_599/SUMMER/SUMMER_2025.csv"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>summer_2024 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/scratch/ope4/BIO_599/SUMMER/SUMMER_2024.csv"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summer_2025)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Species"      "SP_CODE"      "Tree_name"    "PLOT"         "Level"       
 [6] "REPS"         "Dendrometer"  "Time"         "Stress_Level" "FW"          
[11] "DW"           "WP"           "LT"           "LWC"          "Y"           
[16] "X"            "DBH"          "Height"       "Year"         "X.1"         
[21] "X.2"          "X.3"          "X.4"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summer_2024)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PLOT"         "Tree_name"    "DBH"          "Height"       "Species"     
 [6] "SP_CODE"      "Stress_Level" "REPS"         "Level"        "WP"          
[11] "FW"           "DW"           "TW"           "LWC"          "RWC"         
[16] "Time"         "Year"         "Dendrometer" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert FW and DW to numeric if they are not</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>summer_2025<span class="sc">$</span>FW <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summer_2025<span class="sc">$</span>FW)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace commas with dots (for decimal), convert empty strings to NA</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>summer_2025<span class="sc">$</span>DW <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(summer_2025<span class="sc">$</span>DW <span class="sc">==</span> <span class="st">""</span>, <span class="cn">NA</span>, <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, summer_2025<span class="sc">$</span>DW)))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>summer_2025<span class="sc">$</span>LDMC <span class="ot">&lt;-</span> summer_2025<span class="sc">$</span>DW<span class="sc">/</span>summer_2025<span class="sc">$</span>FW</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>summer_2024<span class="sc">$</span>FW <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summer_2024<span class="sc">$</span>FW)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>summer_2024<span class="sc">$</span>DW <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summer_2024<span class="sc">$</span>DW)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>summer_2024<span class="sc">$</span>LDMC <span class="ot">&lt;-</span> summer_2024<span class="sc">$</span>DW<span class="sc">/</span>summer_2024<span class="sc">$</span>FW</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>summer_2024<span class="sc">$</span>DBH <span class="ot">&lt;-</span> summer_2024<span class="sc">$</span>DBH <span class="sc">*</span> <span class="fl">2.54</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>summer_2025 <span class="ot">&lt;-</span> summer_2025 <span class="sc">|&gt;</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X<span class="fl">.1</span>, <span class="sc">-</span>X<span class="fl">.2</span>, <span class="sc">-</span>X<span class="fl">.3</span>, <span class="sc">-</span>X<span class="fl">.4</span>, <span class="sc">-</span>FW, <span class="sc">-</span>DW, <span class="sc">-</span>Species) <span class="sc">|&gt;</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(REPS))</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>summer_2024 <span class="ot">&lt;-</span> summer_2024 <span class="sc">|&gt;</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>TW, <span class="sc">-</span>FW, <span class="sc">-</span>DW, <span class="sc">-</span>Species) <span class="sc">|&gt;</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(REPS))</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summer_2025)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SP_CODE"      "Tree_name"    "PLOT"         "Level"        "REPS"        
 [6] "Dendrometer"  "Time"         "Stress_Level" "WP"           "LT"          
[11] "LWC"          "Y"            "X"            "DBH"          "Height"      
[16] "Year"         "LDMC"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summer_2024)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PLOT"         "Tree_name"    "DBH"          "Height"       "SP_CODE"     
 [6] "Stress_Level" "REPS"         "Level"        "WP"           "LWC"         
[11] "RWC"          "Time"         "Year"         "Dendrometer"  "LDMC"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(summer_2025)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SP_CODE           Tree_name             PLOT              Level          
 Length:419         Length:419         Length:419         Length:419        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  




      REPS        Dendrometer           Time            Stress_Level   
 Min.   :1.000   Min.   :92240313   Length:419         Min.   : 0.000  
 1st Qu.:1.000   1st Qu.:92246644   Class :character   1st Qu.: 6.000  
 Median :1.000   Median :92246669   Mode  :character   Median : 9.000  
 Mean   :1.112   Mean   :92379302                      Mean   : 7.382  
 3rd Qu.:1.000   3rd Qu.:92248307                      3rd Qu.:10.000  
 Max.   :3.000   Max.   :99246685                      Max.   :10.000  
                                                       NA's   :8       
       WP               LT              LWC                Y        
 Min.   :-3.017   Min.   :0.1333   Min.   :-1.4268   Min.   :32.37  
 1st Qu.: 1.623   1st Qu.:0.5333   1st Qu.: 0.4349   1st Qu.:33.87  
 Median : 2.260   Median :0.7333   Median : 0.5031   Median :34.96  
 Mean   : 2.423   Mean   :0.8263   Mean   : 0.4769   Mean   :34.42  
 3rd Qu.: 3.188   3rd Qu.:1.1417   3rd Qu.: 0.5566   3rd Qu.:35.16  
 Max.   : 5.942   Max.   :2.5530   Max.   : 0.9560   Max.   :35.53  
 NA's   :124      NA's   :191      NA's   :179                      
       X               DBH            Height           Year     
 Min.   :-113.9   Min.   : 33.2   Min.   : 2.40   Min.   :2025  
 1st Qu.:-111.7   1st Qu.:102.8   1st Qu.: 7.40   1st Qu.:2025  
 Median :-111.5   Median :139.3   Median :16.60   Median :2025  
 Mean   :-111.5   Mean   :150.5   Mean   :15.65   Mean   :2025  
 3rd Qu.:-110.8   3rd Qu.:196.3   3rd Qu.:21.10   3rd Qu.:2025  
 Max.   :-109.2   Max.   :341.0   Max.   :38.80   Max.   :2025  
                  NA's   :24      NA's   :18                    
      LDMC        
 Min.   :0.04398  
 1st Qu.:0.44186  
 Median :0.49383  
 Mean   :0.52234  
 3rd Qu.:0.56481  
 Max.   :2.42683  
 NA's   :178      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(summer_2024)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     PLOT            Tree_name              DBH             Height     
 Length:134         Length:134         Min.   : 25.06   Min.   : 2.40  
 Class :character   Class :character   1st Qu.: 84.96   1st Qu.:12.40  
 Mode  :character   Mode  :character   Median :123.47   Median :19.05  
                                       Mean   :128.54   Mean   :19.24  
                                       3rd Qu.:167.51   3rd Qu.:24.60  
                                       Max.   :251.28   Max.   :45.54  
                                                        NA's   :2      
   SP_CODE           Stress_Level         REPS      Level          
 Length:134         Min.   : 0.000   Min.   :1   Length:134        
 Class :character   1st Qu.: 4.000   1st Qu.:1   Class :character  
 Mode  :character   Median : 7.000   Median :1   Mode  :character  
                    Mean   : 6.507   Mean   :1                     
                    3rd Qu.: 9.000   3rd Qu.:1                     
                    Max.   :10.000   Max.   :1                     

       WP             LWC               RWC             Time          
 Min.   :1.263   Min.   :0.03845   Min.   :0.1328   Length:134        
 1st Qu.:1.900   1st Qu.:0.44913   1st Qu.:0.7598   Class :character  
 Median :2.397   Median :0.48925   Median :0.8210   Mode  :character  
 Mean   :2.490   Mean   :0.47616   Mean   :0.7947                     
 3rd Qu.:2.877   3rd Qu.:0.52422   3rd Qu.:0.9017                     
 Max.   :4.900   Max.   :0.73388   Max.   :1.2772                     
 NA's   :28      NA's   :28        NA's   :62                         
      Year       Dendrometer            LDMC       
 Min.   :2024   Min.   :92240312   Min.   :0.2661  
 1st Qu.:2024   1st Qu.:92240361   1st Qu.:0.4758  
 Median :2024   Median :92246652   Median :0.5108  
 Mean   :2024   Mean   :92348971   Mean   :0.5238  
 3rd Qu.:2024   3rd Qu.:92246669   3rd Qu.:0.5509  
 Max.   :2024   Max.   :99246685   Max.   :0.9615  
                                   NA's   :28      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Tree_name and coordinates from summer_2025</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>coords_2025 <span class="ot">&lt;-</span> summer_2025 <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Tree_name, X, Y) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()  <span class="co"># keep only one row per Tree_name</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Join X and Y into summer_2024</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>summer_2024 <span class="ot">&lt;-</span> summer_2024 <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coords_2025, <span class="at">by =</span> <span class="st">"Tree_name"</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Row-bind the two datasets</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>merged_summer <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(summer_2024, summer_2025)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="do">##look at summary stat</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged_summer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     PLOT            Tree_name              DBH             Height     
 Length:553         Length:553         Min.   : 25.06   Min.   : 2.40  
 Class :character   Class :character   1st Qu.: 99.10   1st Qu.: 8.60  
 Mode  :character   Mode  :character   Median :138.00   Median :16.70  
                                       Mean   :144.91   Mean   :16.54  
                                       3rd Qu.:181.10   3rd Qu.:22.65  
                                       Max.   :341.00   Max.   :45.54  
                                       NA's   :24       NA's   :20     
   SP_CODE           Stress_Level         REPS          Level          
 Length:553         Min.   : 0.000   Min.   :1.000   Length:553        
 Class :character   1st Qu.: 4.000   1st Qu.:1.000   Class :character  
 Mode  :character   Median : 9.000   Median :1.000   Mode  :character  
                    Mean   : 7.167   Mean   :1.085                     
                    3rd Qu.:10.000   3rd Qu.:1.000                     
                    Max.   :10.000   Max.   :3.000                     
                    NA's   :8                                          
       WP              LWC               RWC             Time          
 Min.   :-3.017   Min.   :-1.4268   Min.   :0.1328   Length:553        
 1st Qu.: 1.750   1st Qu.: 0.4379   1st Qu.:0.7598   Class :character  
 Median : 2.350   Median : 0.4899   Median :0.8210   Mode  :character  
 Mean   : 2.441   Mean   : 0.4767   Mean   :0.7947                     
 3rd Qu.: 3.057   3rd Qu.: 0.5525   3rd Qu.:0.9017                     
 Max.   : 5.942   Max.   : 0.9560   Max.   :1.2772                     
 NA's   :152      NA's   :207       NA's   :481                        
      Year       Dendrometer            LDMC               X         
 Min.   :2024   Min.   :92240312   Min.   :0.04398   Min.   :-113.9  
 1st Qu.:2025   1st Qu.:92240373   1st Qu.:0.44643   1st Qu.:-111.7  
 Median :2025   Median :92246664   Median :0.51003   Median :-111.5  
 Mean   :2025   Mean   :92371952   Mean   :0.52280   Mean   :-111.5  
 3rd Qu.:2025   3rd Qu.:92248301   3rd Qu.:0.56201   3rd Qu.:-110.8  
 Max.   :2025   Max.   :99246685   Max.   :2.42683   Max.   :-109.2  
                                   NA's   :206       NA's   :40      
       Y               LT        
 Min.   :32.37   Min.   :0.1333  
 1st Qu.:34.25   1st Qu.:0.5333  
 Median :34.96   Median :0.7333  
 Mean   :34.51   Mean   :0.8263  
 3rd Qu.:35.16   3rd Qu.:1.1417  
 Max.   :35.53   Max.   :2.5530  
 NA's   :40      NA's   :325     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the distribution of samples for each factor</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(merged_summer[ , <span class="fu">c</span>(<span class="st">"SP_CODE"</span>, <span class="st">"PLOT"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       PLOT
SP_CODE AP ARB BR FR JD KB KM LM ML SB SK SL TO
   ABCO  6   0  0  0  0  2  0  0 18 18 10  2  6
   ABLA  6   0  0  0  0  2  0  0  0  0  0  0  0
   JUMO  0   0 24  0 33  0  0  0  0  0  0  0  0
   JUOS  0   0  0  0  0  0 24 16  0  0  0  0  0
   PIED  0   0  4  0  8  0  0  0  0  0  0  0  0
   PIEN  0   0  0  0  0  2  0  0  0  0  0  0  0
   PILE  0   0  0  0  0  0  0  0  0  0  6  0  0
   PIPO  0  48  0 30  0  0 32 40 30  0  8  0  0
   PIPU 12   0  0  0  0  4  0  0  0  0  0  0  0
   PIST  6   0  0  2  0  0  0  0  0  0  6  0  0
   POTR  0   0  0 12  0 10  0  0  0  0  0  0  0
   PSME  6   0  0  4  0  4  0  0  0  0 38  2  0
   QUEM  0   0  0  0  0  0  0  0  0  0 12  0  0
   QUGA  0   0  0  0  0  0  0 16 20  0  0  0 12
   QUHY  0   0  0  0  0  0  0  0  0  0 12  0  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EDA</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numeric columns that could be predictors</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> merged_summer <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DBH, Height, WP, LWC, RWC, LT, LDMC)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix (pairwise, excluding NAs)</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictors, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the correlation matrix</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         DBH Height    WP   LWC   RWC    LT  LDMC
DBH     1.00   0.69 -0.26  0.07  0.01 -0.05 -0.08
Height  0.69   1.00 -0.46  0.17 -0.19 -0.45 -0.18
WP     -0.26  -0.46  1.00 -0.48 -0.22  0.24  0.47
LWC     0.07   0.17 -0.48  1.00  0.67 -0.16 -1.00
RWC     0.01  -0.19 -0.22  0.67  1.00    NA -0.67
LT     -0.05  -0.45  0.24 -0.16    NA  1.00  0.16
LDMC   -0.08  -0.18  0.47 -1.00 -0.67  0.16  1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GGally::ggpairs(predictors)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="do">##get the absolute value of LWC</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>merged_summer<span class="sc">$</span>LWC <span class="ot">&lt;-</span> <span class="fu">abs</span>(merged_summer<span class="sc">$</span>LWC)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>merged_summer<span class="sc">$</span>WP <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">abs</span>(merged_summer<span class="sc">$</span>WP)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the distribution of continuous </span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>DBH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>WP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>LWC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>RWC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>LT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(merged_summer<span class="sc">$</span>LDMC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>DBH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>WP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>LWC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>RWC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>LT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(merged_summer<span class="sc">$</span>LDMC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-6-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only Dendro_number and Trend from trend_all</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>trend_subset <span class="ot">&lt;-</span> trend_all <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dendro_number, Trend, Slope) <span class="sc">|&gt;</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Join Trend into merged_summer by matching dendrometer numbers</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>merged_summer <span class="ot">&lt;-</span> merged_summer <span class="sc">%&gt;%</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(trend_subset, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Dendrometer"</span> <span class="ot">=</span> <span class="st">"Dendro_number"</span>)) </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>merged_summer <span class="ot">&lt;-</span> merged_summer <span class="sc">%&gt;%</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Trend))  <span class="sc">%&gt;%</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trend <span class="sc">!=</span> <span class="st">"not enough data"</span>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(merged_summer<span class="sc">$</span>Dendrometer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged_summer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     PLOT            Tree_name              DBH             Height      
 Length:488         Length:488         Min.   : 25.06   Min.   : 2.400  
 Class :character   Class :character   1st Qu.: 97.80   1st Qu.: 8.502  
 Mode  :character   Mode  :character   Median :135.75   Median :16.600  
                                       Mean   :144.15   Mean   :16.134  
                                       3rd Qu.:185.40   3rd Qu.:21.100  
                                       Max.   :341.00   Max.   :39.880  
                                       NA's   :24       NA's   :18      
   SP_CODE           Stress_Level         REPS         Level          
 Length:488         Min.   : 0.000   Min.   :1.00   Length:488        
 Class :character   1st Qu.: 6.000   1st Qu.:1.00   Class :character  
 Mode  :character   Median : 9.000   Median :1.00   Mode  :character  
                    Mean   : 7.425   Mean   :1.09                     
                    3rd Qu.:10.000   3rd Qu.:1.00                     
                    Max.   :10.000   Max.   :3.00                     
                    NA's   :8                                         
       WP              LWC               RWC             Time          
 Min.   :-5.942   Min.   :0.03845   Min.   :0.1328   Length:488        
 1st Qu.:-3.110   1st Qu.:0.43582   1st Qu.:0.7374   Class :character  
 Median :-2.368   Median :0.49350   Median :0.7953   Mode  :character  
 Mean   :-2.513   Mean   :0.49624   Mean   :0.7762                     
 3rd Qu.:-1.744   3rd Qu.:0.55357   3rd Qu.:0.8786                     
 Max.   :-0.185   Max.   :1.42683   Max.   :1.2772                     
 NA's   :141      NA's   :193       NA's   :432                        
      Year       Dendrometer            LDMC               X         
 Min.   :2024   Min.   :92240313   Min.   :0.04398   Min.   :-113.9  
 1st Qu.:2025   1st Qu.:92240375   1st Qu.:0.44822   1st Qu.:-111.7  
 Median :2025   Median :92246664   Median :0.51006   Median :-111.5  
 Mean   :2025   Mean   :92245496   Mean   :0.52801   Mean   :-111.5  
 3rd Qu.:2025   3rd Qu.:92248302   3rd Qu.:0.56459   3rd Qu.:-110.8  
 Max.   :2025   Max.   :92248330   Max.   :2.42683   Max.   :-109.2  
                                   NA's   :192                       
       Y               LT            Trend               Slope         
 Min.   :32.37   Min.   :0.1333   Length:488         Min.   :-10.9455  
 1st Qu.:33.95   1st Qu.:0.5333   Class :character   1st Qu.: -1.1203  
 Median :34.96   Median :0.7333   Mode  :character   Median : -0.0304  
 Mean   :34.47   Mean   :0.8210                      Mean   : -0.8976  
 3rd Qu.:35.16   3rd Qu.:1.1167                      3rd Qu.:  0.1357  
 Max.   :35.53   Max.   :2.5530                      Max.   :  5.6149  
                 NA's   :269                                           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise predictors by Year and Tree_name</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>merged_summary <span class="ot">&lt;-</span> merged_summer <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tree_name, Time, Year) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">PLOT =</span> <span class="fu">first</span>(PLOT),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SP_CODE =</span> <span class="fu">first</span>(SP_CODE),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Trend =</span> <span class="fu">first</span>(Trend),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Slope =</span> <span class="fu">first</span>(Slope),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stress_Level =</span> <span class="fu">first</span>(Stress_Level),</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">DBH =</span> <span class="fu">mean</span>(DBH, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Height =</span> <span class="fu">mean</span>(Height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">LWC =</span> <span class="fu">mean</span>(LWC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">RWC =</span> <span class="fu">mean</span>(RWC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">LT =</span> <span class="fu">mean</span>(LT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">WP =</span> <span class="fu">mean</span>(WP, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">LDMC =</span> <span class="fu">mean</span>(LDMC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="do">##scale all predictors</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="do">##scale the varaibes</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>merged_summary <span class="ot">&lt;-</span> merged_summary <span class="sc">%&gt;%</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(LWC, LDMC, DBH, Height, RWC, LT, WP),</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span><span class="fu">scale</span>(.),</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">"z_{.col}"</span>)) </span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tree_name             Time                Year          PLOT          
 Length:191         Length:191         Min.   :2024   Length:191        
 Class :character   Class :character   1st Qu.:2025   Class :character  
 Mode  :character   Mode  :character   Median :2025   Mode  :character  
                                       Mean   :2025                     
                                       3rd Qu.:2025                     
                                       Max.   :2025                     

   SP_CODE             Trend               Slope           Stress_Level   
 Length:191         Length:191         Min.   :-10.9455   Min.   : 0.000  
 Class :character   Class :character   1st Qu.: -1.1168   1st Qu.: 5.750  
 Mode  :character   Mode  :character   Median : -0.0304   Median : 9.000  
                                       Mean   : -0.8277   Mean   : 7.176  
                                       3rd Qu.:  0.1255   3rd Qu.:10.000  
                                       Max.   :  5.6149   Max.   :10.000  
                                                          NA's   :3       
      DBH             Height           LWC               RWC        
 Min.   : 25.06   Min.   : 2.40   Min.   :0.04098   Min.   :0.1422  
 1st Qu.: 93.25   1st Qu.: 7.80   1st Qu.:0.44358   1st Qu.:0.7531  
 Median :126.60   Median :16.55   Median :0.49937   Median :0.8077  
 Mean   :138.00   Mean   :15.69   Mean   :0.49457   Mean   :0.7762  
 3rd Qu.:168.50   3rd Qu.:21.00   3rd Qu.:0.55469   3rd Qu.:0.8501  
 Max.   :341.00   Max.   :39.88   Max.   :0.89434   Max.   :1.1614  
 NA's   :12       NA's   :9       NA's   :54        NA's   :163     
       LT               WP               LDMC             z_LWC.V1     
 Min.   :0.1333   Min.   :-5.9420   Min.   :0.1057   Min.   :-3.64993  
 1st Qu.:0.5167   1st Qu.:-3.1265   1st Qu.:0.4535   1st Qu.:-0.41031  
 Median :0.7458   Median :-2.4370   Median :0.5068   Median : 0.03866  
 Mean   :0.8403   Mean   :-2.5804   Mean   :0.5322   Mean   : 0.00000  
 3rd Qu.:1.1875   3rd Qu.:-1.7770   3rd Qu.:0.5569   3rd Qu.: 0.48383  
 Max.   :2.3952   Max.   :-0.7464   Max.   :1.7811   Max.   : 3.21689  
 NA's   :91       NA's   :50        NA's   :54       NA's   :54        
     z_LDMC.V1           z_DBH.V1           z_Height.V1          z_RWC.V1     
 Min.   :-2.10178   Min.   :-1.794925   Min.   :-1.413847   Min.   :-3.06126  
 1st Qu.:-0.38785   1st Qu.:-0.711256   1st Qu.:-0.839313   1st Qu.:-0.11158  
 Median :-0.12515   Median :-0.181224   Median : 0.091645   Median : 0.15228  
 Mean   : 0.00000   Mean   : 0.000000   Mean   : 0.000000   Mean   : 0.00000  
 3rd Qu.: 0.12194   3rd Qu.: 0.484694   3rd Qu.: 0.565104   3rd Qu.: 0.35679  
 Max.   : 6.15424   Max.   : 3.226238   Max.   : 2.573845   Max.   : 1.85994  
 NA's   :54         NA's   :12          NA's   :9           NA's   :163       
      z_LT.V1            z_WP.V1      
 Min.   :-1.58212   Min.   :-3.11783  
 1st Qu.:-0.72428   1st Qu.:-0.50651  
 Median :-0.21163   Median : 0.13298  
 Mean   : 0.00000   Mean   : 0.00000  
 3rd Qu.: 0.77692   3rd Qu.: 0.74512  
 Max.   : 3.47947   Max.   : 1.70098  
 NA's   :91         NA's   :50        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with NAs in predictors </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>model_data <span class="ot">&lt;-</span> merged_summary <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(z_DBH) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(z_Height) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(z_LWC) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(z_WP) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(z_LDMC) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Trend))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using one column matrices in `filter()` was deprecated in dplyr 1.1.0.
ℹ Please use one dimensional logical vectors instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tree_name             Time                Year          PLOT          
 Length:131         Length:131         Min.   :2024   Length:131        
 Class :character   Class :character   1st Qu.:2025   Class :character  
 Mode  :character   Mode  :character   Median :2025   Mode  :character  
                                       Mean   :2025                     
                                       3rd Qu.:2025                     
                                       Max.   :2025                     

   SP_CODE             Trend               Slope            Stress_Level   
 Length:131         Length:131         Min.   :-10.94552   Min.   : 0.000  
 Class :character   Class :character   1st Qu.: -1.12385   1st Qu.: 7.000  
 Mode  :character   Mode  :character   Median : -0.03758   Median : 9.000  
                                       Mean   : -0.92000   Mean   : 7.809  
                                       3rd Qu.:  0.10061   3rd Qu.:10.000  
                                       Max.   :  5.61494   Max.   :10.000  

      DBH             Height            LWC               RWC        
 Min.   : 33.20   Min.   : 2.400   Min.   :0.04485   Min.   :0.1422  
 1st Qu.: 94.25   1st Qu.: 7.599   1st Qu.:0.44588   1st Qu.:0.7719  
 Median :125.20   Median :15.100   Median :0.49991   Median :0.8080  
 Mean   :141.17   Mean   :15.597   Mean   :0.49860   Mean   :0.7949  
 3rd Qu.:186.45   3rd Qu.:21.000   3rd Qu.:0.55120   3rd Qu.:0.8593  
 Max.   :341.00   Max.   :39.880   Max.   :0.89434   Max.   :1.1614  
                                                     NA's   :104     
       LT               WP               LDMC             z_LWC.V1      
 Min.   :0.1333   Min.   :-5.9420   Min.   :0.1057   Min.   :-3.618804  
 1st Qu.:0.5167   1st Qu.:-3.1450   1st Qu.:0.4540   1st Qu.:-0.391803  
 Median :0.7347   Median :-2.4750   Median :0.5008   Median : 0.043046  
 Mean   :0.8176   Mean   :-2.6129   Mean   :0.5294   Mean   : 0.032432  
 3rd Qu.:1.1375   3rd Qu.:-1.8702   3rd Qu.:0.5565   3rd Qu.: 0.455754  
 Max.   :2.3952   Max.   :-0.7464   Max.   :1.7811   Max.   : 3.216893  
 NA's   :41                                                             
      z_LDMC.V1           z_DBH.V1           z_Height.V1     
 Min.   :-2.101780   Min.   :-1.665631   Min.   :-1.4138467  
 1st Qu.:-0.385250   1st Qu.:-0.695362   1st Qu.:-0.8607088  
 Median :-0.154735   Median :-0.203474   Median :-0.0626279  
 Mean   :-0.013819   Mean   : 0.050304   Mean   :-0.0097427  
 3rd Qu.: 0.119846   3rd Qu.: 0.769973   3rd Qu.: 0.5651036  
 Max.   : 6.154242   Max.   : 3.226238   Max.   : 2.5738445  

      z_RWC.V1           z_LT.V1             z_WP.V1       
 Min.   :-3.06126   Min.   :-1.58212   Min.   :-3.1178320  
 1st Qu.:-0.02093   1st Qu.:-0.72428   1st Qu.:-0.5236725  
 Median : 0.15356   Median :-0.23644   Median : 0.0977386  
 Mean   : 0.09017   Mean   :-0.05082   Mean   :-0.0301594  
 3rd Qu.: 0.40137   3rd Qu.: 0.66503   3rd Qu.: 0.6586316  
 Max.   : 1.85994   Max.   : 3.47947   Max.   : 1.7009792  
 NA's   :104        NA's   :41                             </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">##linear model</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>model_data<span class="sc">$</span>Stress_Level <span class="ot">&lt;-</span> <span class="fu">factor</span>(model_data<span class="sc">$</span>Stress_Level, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span> (Slope<span class="sc">~</span>z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level, <span class="at">data =</span> model_data )</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Slope ~ z_WP + z_DBH + z_LWC + z_LDMC + z_Height + 
    Stress_Level, data = model_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7387 -0.5234  0.3980  1.2524  6.6947 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     -0.85233    0.38840  -2.194   0.0302 *
z_WP            -0.14582    0.33121  -0.440   0.6606  
z_DBH           -0.21567    0.32999  -0.654   0.5147  
z_LWC           -0.20248    0.28119  -0.720   0.4729  
z_LDMC           0.21020    0.26290   0.800   0.4256  
z_Height         0.37713    0.36792   1.025   0.3075  
Stress_Level.L   0.64493    1.52850   0.422   0.6739  
Stress_Level.Q  -2.31017    1.58318  -1.459   0.1472  
Stress_Level.C   2.83230    1.44372   1.962   0.0522 .
Stress_Level^4  -1.30083    1.38209  -0.941   0.3486  
Stress_Level^5  -0.70388    1.09876  -0.641   0.5230  
Stress_Level^6   0.18556    1.06995   0.173   0.8626  
Stress_Level^7   0.48147    1.03916   0.463   0.6440  
Stress_Level^8   2.03206    1.10397   1.841   0.0682 .
Stress_Level^9   0.01823    1.01117   0.018   0.9856  
Stress_Level^10 -0.23446    1.23857  -0.189   0.8502  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 115 degrees of freedom
Multiple R-squared:  0.117, Adjusted R-squared:  0.00185 
F-statistic: 1.016 on 15 and 115 DF,  p-value: 0.444</code></pre>
</div>
</div>
<h1 id="h1">H1</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>gls_1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(Slope<span class="sc">~</span>z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level, <span class="at">data =</span> model_data )</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(gls_1)</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>M1.nested <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> Slope <span class="sc">~</span> z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> PLOT <span class="sc">/</span> SP_CODE, <span class="co"># nested random effects: SPECIES within PLOT</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> model_data,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"REML"</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(M1.nested)</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co">#compare new (model with variance by species and plot) and old model (model without any variance structure)</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(gls_1, M1.nested)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Model df      AIC      BIC    logLik   Test  L.Ratio p-value
gls_1         1 17 617.3230 663.9868 -291.6615                        
M1.nested     2 19 575.4121 627.5658 -268.7061 1 vs 2 45.91086  &lt;.0001</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Random slopes for species</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>M1.species<span class="ot">=</span> <span class="fu">lme</span>(Slope <span class="sc">~</span> z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level, <span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>SP_CODE, </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> model_data, <span class="at">method=</span><span class="st">"REML"</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(M1.species)</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">#for plots instead</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>M1.plot <span class="ot">&lt;-</span> <span class="fu">lme</span>(Slope <span class="sc">~</span> z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level, <span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>PLOT, </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> model_data, <span class="at">method=</span><span class="st">"REML"</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(M1.plot)</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(gls_1, M1.nested, M1.species, M1.plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Model df      AIC      BIC    logLik   Test  L.Ratio p-value
gls_1          1 17 617.3230 663.9868 -291.6615                        
M1.nested      2 19 575.4121 627.5658 -268.7061 1 vs 2 45.91086  &lt;.0001
M1.species     3 18 592.2491 641.6578 -278.1245 2 vs 3 18.83693  &lt;.0001
M1.plot        4 18 602.1540 651.5628 -283.0770                        </code></pre>
</div>
</div>
<p><strong>Perform Model Selection</strong></p>
<ul>
<li><p>Use model selection criteria (e.g., AIC, delta AIC, likelihood ratio tests) to justify your top model</p></li>
<li><p>This can include identifying the best random structure and the best fixed structure.&nbsp;</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(M1.nested)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>lme1_ml <span class="ot">&lt;-</span> <span class="fu">update</span>(M1.nested, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(lme1_ml, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Slope ~ z_WP + z_DBH + z_LWC + z_LDMC + z_Height + Stress_Level
             Df    AIC     LRT Pr(&gt;Chi)  
&lt;none&gt;          583.66                   
z_WP          1 582.79  1.1310  0.28756  
z_DBH         1 581.71  0.0483  0.82597  
z_LWC         1 586.04  4.3814  0.03633 *
z_LDMC        1 582.19  0.5317  0.46589  
z_Height      1 583.33  1.6641  0.19706  
Stress_Level 10 583.62 19.9554  0.02968 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Refit with REML and validate</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co">#After selecting the optimal fixed structure, refit the model using REML for final coefficient estimates.</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>lme_final <span class="ot">&lt;-</span> <span class="fu">update</span>(M1.nested, <span class="at">fixed =</span> Slope <span class="sc">~</span> z_LWC <span class="sc">+</span> Stress_Level,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lme_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: model_data 
       AIC      BIC    logLik
  568.1575 609.8444 -269.0788

Random effects:
 Formula: ~1 | PLOT
        (Intercept)
StdDev:   0.9487889

 Formula: ~1 | SP_CODE %in% PLOT
        (Intercept) Residual
StdDev:    1.892091 1.684395

Fixed effects:  Slope ~ z_LWC + Stress_Level 
                    Value Std.Error DF    t-value p-value
(Intercept)     -0.878543 0.5606657 92 -1.5669633  0.1206
z_LWC           -0.401715 0.1945960 92 -2.0643557  0.0418
Stress_Level.L   0.143333 1.0972991 92  0.1306238  0.8964
Stress_Level.Q  -2.012433 1.1957143 92 -1.6830383  0.0958
Stress_Level.C   3.165308 1.1023298 92  2.8714709  0.0051
Stress_Level^4  -2.210275 1.0204341 92 -2.1660140  0.0329
Stress_Level^5   0.082436 0.8321280 92  0.0990669  0.9213
Stress_Level^6  -0.597546 0.7789807 92 -0.7670865  0.4450
Stress_Level^7   0.939659 0.7963151 92  1.1800091  0.2410
Stress_Level^8   1.126472 0.8096409 92  1.3913235  0.1675
Stress_Level^9  -0.833390 0.8308338 92 -1.0030764  0.3185
Stress_Level^10 -0.023243 0.9868006 92 -0.0235537  0.9813
 Correlation: 
                (Intr) z_LWC  St_L.L St_L.Q St_L.C St_L^4 St_L^5 St_L^6 St_L^7
z_LWC            0.125                                                        
Stress_Level.L  -0.357 -0.320                                                 
Stress_Level.Q   0.129  0.244 -0.652                                          
Stress_Level.C  -0.162 -0.260  0.433 -0.723                                   
Stress_Level^4   0.216  0.322 -0.469  0.365 -0.632                            
Stress_Level^5  -0.182 -0.297  0.446 -0.341  0.328 -0.579                     
Stress_Level^6   0.028  0.180 -0.281  0.350 -0.237  0.105 -0.400              
Stress_Level^7  -0.063 -0.103  0.174 -0.197  0.147  0.025 -0.079 -0.299       
Stress_Level^8   0.084  0.067 -0.026 -0.008 -0.097  0.113  0.059 -0.123 -0.308
Stress_Level^9  -0.081  0.000  0.029  0.079  0.006 -0.138  0.126  0.090 -0.118
Stress_Level^10 -0.001 -0.030 -0.016 -0.064  0.054 -0.019 -0.096  0.111  0.101
                St_L^8 St_L^9
z_LWC                        
Stress_Level.L               
Stress_Level.Q               
Stress_Level.C               
Stress_Level^4               
Stress_Level^5               
Stress_Level^6               
Stress_Level^7               
Stress_Level^8               
Stress_Level^9  -0.237       
Stress_Level^10 -0.183 -0.387

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-3.13567316 -0.42536427  0.04408892  0.42943001  2.92369987 

Number of Observations: 131
Number of Groups: 
             PLOT SP_CODE %in% PLOT 
               11                28 </code></pre>
</div>
</div></li>
<li><p><strong>Create a Representative Figure of Your Model (5 points)</strong></p></li>
</ol>
<ul>
<li><p>Include a figure that effectively communicates a key model result.</p></li>
<li><p>Examples: regression plot with CI, coefficient plot, or fitted vs.&nbsp;observed.</p></li>
<li><p>Ensure the figure includes a descriptive caption, clear axis labels, and appropriate units.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(lme_final, <span class="at">show.se=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Slope</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Error</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.56</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.99&nbsp;–&nbsp;0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.121</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z LWC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.79&nbsp;–&nbsp;-0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.042</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [linear]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.04&nbsp;–&nbsp;2.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.896</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [quadratic]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.39&nbsp;–&nbsp;0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.096</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [cubic]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.98&nbsp;–&nbsp;5.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.005</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [4th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.24&nbsp;–&nbsp;-0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.033</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [5th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.57&nbsp;–&nbsp;1.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.921</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [6th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.14&nbsp;–&nbsp;0.95</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.445</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [7th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.64&nbsp;–&nbsp;2.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.241</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [8th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.48&nbsp;–&nbsp;2.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.167</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [9th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.48&nbsp;–&nbsp;0.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.318</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [10th<br>degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.98&nbsp;–&nbsp;1.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.981</td>
</tr>
<tr>
<td colspan="5" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">2.84</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>SP_CODE</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.95</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>PLOT</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">1.89</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>SP_CODE</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">13</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>PLOT</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">11</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">131</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.104 / 0.552</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lme_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting missing values (`NA`) into regular values currently not
  possible for variables of class `NULL`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted values from the model for danger</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lme_final, <span class="at">terms =</span> <span class="st">"z_LWC"</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions with confidence intervals</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred, <span class="at">show_data =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"LWC (g)"</span>,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted change in TWD (De_trend slope)"</span>,</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted relationship between LWC and TWD"</span>) <span class="sc">+</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data points may overlap. Use the `jitter` argument to add some amount of
  random variation to the location of data points and avoid overplotting.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><strong>Evaluate Model Assumptions (10 points)</strong></li>
</ol>
<ul>
<li><p>Use residual plots, QQ plots, or other diagnostics to assess model assumptions.</p></li>
<li><p>Discuss any violations and how you addressed them.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#full model with all fixed and random effects</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Check for assumption violations:</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co">#- Homogeneity of residuals.</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#- Normality.</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#- Outliers.</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(M1.nested) <span class="sc">~</span> model_data<span class="sc">$</span>z_LWC, <span class="at">xlab =</span> <span class="st">"LWC"</span>, <span class="at">ylab =</span> <span class="st">"Normalized residuals"</span>)<span class="sc">+</span><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M1.nested)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(M1.nested)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting missing values (`NA`) into regular values currently not
  possible for variables of class `NULL`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">##model from model selection</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Check for assumption violations:</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#- Homogeneity of residuals.</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#- Normality.</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#- Outliers.</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lme_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lme_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting missing values (`NA`) into regular values currently not
  possible for variables of class `NULL`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="h2" class="level1">
<h1>H2</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>gls_2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(Slope<span class="sc">~</span>z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level <span class="sc">+</span> SP_CODE, <span class="at">data =</span> model_data )</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(gls_2)</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>M1.Tree_random <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  Slope <span class="sc">~</span> z_WP <span class="sc">+</span> z_DBH <span class="sc">+</span> z_LWC <span class="sc">+</span> z_LDMC <span class="sc">+</span> z_Height <span class="sc">+</span> Stress_Level <span class="sc">+</span> SP_CODE,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> PLOT,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> model_data</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1.Tree_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: model_data 
       AIC      BIC    logLik
  543.8564 622.8983 -241.9282

Random effects:
 Formula: ~1 | PLOT
        (Intercept) Residual
StdDev:    1.561383 1.760033

Fixed effects:  Slope ~ z_WP + z_DBH + z_LWC + z_LDMC + z_Height + Stress_Level +      SP_CODE 
                    Value Std.Error DF   t-value p-value
(Intercept)      0.944266 1.0527730 93  0.896932  0.3721
z_WP            -0.177178 0.2772530 93 -0.639048  0.5244
z_DBH           -0.196764 0.3449347 93 -0.570437  0.5698
z_LWC           -0.464249 0.2178888 93 -2.130670  0.0358
z_LDMC          -0.090970 0.2121304 93 -0.428839  0.6690
z_Height         0.546729 0.5092958 93  1.073500  0.2858
Stress_Level.L  -0.058386 1.2008149 93 -0.048622  0.9613
Stress_Level.Q  -0.416462 1.2223394 93 -0.340709  0.7341
Stress_Level.C   2.803727 1.1302292 93  2.480672  0.0149
Stress_Level^4  -2.616383 1.1160575 93 -2.344308  0.0212
Stress_Level^5   0.341346 0.9128710 93  0.373926  0.7093
Stress_Level^6  -0.892687 0.8269677 93 -1.079470  0.2832
Stress_Level^7   1.089706 0.8369575 93  1.301985  0.1961
Stress_Level^8   1.256625 0.8755606 93  1.435223  0.1546
Stress_Level^9  -0.477514 0.9508650 93 -0.502189  0.6167
Stress_Level^10 -0.866428 1.0925846 93 -0.793008  0.4298
SP_CODEABLA     -1.394995 2.2289410 93 -0.625855  0.5329
SP_CODEJUMO     -0.833126 1.8325725 93 -0.454621  0.6504
SP_CODEJUOS     -3.761654 1.4689662 93 -2.560749  0.0121
SP_CODEPIED     -1.723731 1.8550881 93 -0.929191  0.3552
SP_CODEPILE      2.227317 2.2386750 93  0.994926  0.3224
SP_CODEPIPO     -3.521620 1.0243140 93 -3.438028  0.0009
SP_CODEPIPU      0.293784 1.2168260 93  0.241435  0.8097
SP_CODEPIST     -2.798865 1.1377903 93 -2.459913  0.0157
SP_CODEPSME      1.314046 1.0009178 93  1.312841  0.1925
SP_CODEQUEM     -6.373711 1.6634415 93 -3.831641  0.0002
SP_CODEQUGA     -0.581584 1.2551805 93 -0.463347  0.6442
SP_CODEQUHY     -0.980032 1.5879019 93 -0.617187  0.5386
 Correlation: 
                (Intr) z_WP   z_DBH  z_LWC  z_LDMC z_Hght St_L.L St_L.Q St_L.C
z_WP            -0.089                                                        
z_DBH            0.207 -0.063                                                 
z_LWC            0.018 -0.198  0.053                                          
z_LDMC           0.009  0.326  0.030  0.200                                   
z_Height        -0.377 -0.154 -0.659 -0.021 -0.102                            
Stress_Level.L  -0.193 -0.094 -0.236 -0.263  0.044  0.168                     
Stress_Level.Q  -0.018  0.065 -0.066  0.168 -0.044  0.064 -0.590              
Stress_Level.C  -0.123 -0.146 -0.037 -0.204  0.031  0.105  0.422 -0.695       
Stress_Level^4   0.134  0.150  0.167  0.284 -0.016 -0.176 -0.505  0.284 -0.609
Stress_Level^5  -0.066 -0.138  0.021 -0.239  0.065  0.058  0.441 -0.267  0.312
Stress_Level^6  -0.087 -0.022 -0.053  0.150 -0.026  0.034 -0.231  0.345 -0.229
Stress_Level^7  -0.006 -0.050  0.005 -0.070  0.030 -0.033  0.145 -0.255  0.183
Stress_Level^8  -0.022  0.101 -0.261  0.015  0.002  0.152  0.038 -0.003 -0.084
Stress_Level^9  -0.278  0.086 -0.047 -0.082  0.043  0.105  0.072  0.137 -0.004
Stress_Level^10  0.108 -0.101  0.011  0.041 -0.047 -0.001 -0.054 -0.071  0.021
SP_CODEABLA     -0.069  0.094  0.158  0.061  0.007 -0.111  0.037  0.038 -0.213
SP_CODEJUMO     -0.662  0.128 -0.314  0.006 -0.102  0.496 -0.025  0.071  0.039
SP_CODEJUOS     -0.739  0.238 -0.251  0.035  0.031  0.460 -0.022  0.164 -0.010
SP_CODEPIED     -0.541 -0.073 -0.018  0.127 -0.089  0.302 -0.093  0.045  0.046
SP_CODEPILE     -0.418  0.044 -0.012 -0.171  0.062  0.244  0.157  0.199 -0.034
SP_CODEPIPO     -0.735  0.117 -0.139  0.080 -0.006  0.177 -0.029  0.020  0.074
SP_CODEPIPU     -0.370  0.027  0.101 -0.068  0.019  0.091  0.030  0.080  0.024
SP_CODEPIST     -0.325  0.032  0.223  0.003  0.023  0.002 -0.075 -0.066  0.000
SP_CODEPSME     -0.354  0.111  0.210  0.005  0.040 -0.146 -0.080 -0.028  0.005
SP_CODEQUEM     -0.445  0.041  0.058  0.078 -0.008  0.270  0.067 -0.013 -0.038
SP_CODEQUGA     -0.699  0.189 -0.154  0.026  0.034  0.335 -0.085  0.098  0.041
SP_CODEQUHY     -0.467  0.019  0.084  0.030  0.006  0.290 -0.055  0.029  0.071
                St_L^4 St_L^5 St_L^6 St_L^7 St_L^8 St_L^9 S_L^10 SP_CODEA
z_WP                                                                     
z_DBH                                                                    
z_LWC                                                                    
z_LDMC                                                                   
z_Height                                                                 
Stress_Level.L                                                           
Stress_Level.Q                                                           
Stress_Level.C                                                           
Stress_Level^4                                                           
Stress_Level^5  -0.617                                                   
Stress_Level^6   0.095 -0.370                                            
Stress_Level^7   0.039 -0.099 -0.312                                     
Stress_Level^8   0.053  0.042 -0.106 -0.321                              
Stress_Level^9  -0.193  0.195  0.103 -0.169 -0.192                       
Stress_Level^10  0.062 -0.179  0.083  0.170 -0.163 -0.489                
SP_CODEABLA      0.098  0.082 -0.129 -0.044  0.186 -0.198  0.170         
SP_CODEJUMO      0.001 -0.057  0.069 -0.030  0.089  0.170 -0.044  0.007  
SP_CODEJUOS      0.009 -0.078  0.134  0.016 -0.001  0.322 -0.155  0.005  
SP_CODEPIED      0.039 -0.042  0.038 -0.058 -0.045  0.092 -0.024  0.029  
SP_CODEPILE     -0.277  0.344  0.102 -0.299  0.048  0.498 -0.455  0.017  
SP_CODEPIPO     -0.012 -0.088  0.091 -0.003  0.077  0.204 -0.048  0.066  
SP_CODEPIPU     -0.132  0.058  0.009 -0.055  0.081  0.300 -0.144  0.243  
SP_CODEPIST      0.056  0.039  0.055 -0.002 -0.061  0.089  0.017  0.232  
SP_CODEPSME      0.029 -0.044  0.036  0.007 -0.087  0.028 -0.067  0.157  
SP_CODEQUEM      0.162 -0.149  0.262 -0.090  0.062  0.044 -0.013  0.113  
SP_CODEQUGA      0.065 -0.120  0.131  0.048 -0.050  0.258 -0.073 -0.004  
SP_CODEQUHY      0.037  0.030  0.089  0.031  0.011  0.155 -0.043  0.081  
                SP_CODEJUM SP_CODEJUO SP_CODEPIE SP_CODEPIL SP_CODEPIPO
z_WP                                                                   
z_DBH                                                                  
z_LWC                                                                  
z_LDMC                                                                 
z_Height                                                               
Stress_Level.L                                                         
Stress_Level.Q                                                         
Stress_Level.C                                                         
Stress_Level^4                                                         
Stress_Level^5                                                         
Stress_Level^6                                                         
Stress_Level^7                                                         
Stress_Level^8                                                         
Stress_Level^9                                                         
Stress_Level^10                                                        
SP_CODEABLA                                                            
SP_CODEJUMO                                                            
SP_CODEJUOS      0.594                                                 
SP_CODEPIED      0.784      0.437                                      
SP_CODEPILE      0.244      0.391      0.198                           
SP_CODEPIPO      0.508      0.766      0.416      0.279                
SP_CODEPIPU      0.220      0.312      0.199      0.352      0.319     
SP_CODEPIST      0.209      0.283      0.241      0.248      0.342     
SP_CODEPSME      0.181      0.302      0.220      0.302      0.448     
SP_CODEQUEM      0.332      0.435      0.307      0.332      0.384     
SP_CODEQUGA      0.544      0.753      0.429      0.293      0.729     
SP_CODEQUHY      0.366      0.478      0.338      0.381      0.422     
                SP_CODEPIPU SP_CODEPIS SP_CODEPS SP_CODEQUE SP_CODEQUG
z_WP                                                                  
z_DBH                                                                 
z_LWC                                                                 
z_LDMC                                                                
z_Height                                                              
Stress_Level.L                                                        
Stress_Level.Q                                                        
Stress_Level.C                                                        
Stress_Level^4                                                        
Stress_Level^5                                                        
Stress_Level^6                                                        
Stress_Level^7                                                        
Stress_Level^8                                                        
Stress_Level^9                                                        
Stress_Level^10                                                       
SP_CODEABLA                                                           
SP_CODEJUMO                                                           
SP_CODEJUOS                                                           
SP_CODEPIED                                                           
SP_CODEPILE                                                           
SP_CODEPIPO                                                           
SP_CODEPIPU                                                           
SP_CODEPIST      0.444                                                
SP_CODEPSME      0.308       0.469                                    
SP_CODEQUEM      0.254       0.375      0.419                         
SP_CODEQUGA      0.280       0.299      0.321     0.399               
SP_CODEQUHY      0.311       0.408      0.438     0.528      0.448    

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-2.781376177 -0.451811061 -0.002023604  0.450390194  2.734261406 

Number of Observations: 131
Number of Groups: 11 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(M1.Tree_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Slope</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.15&nbsp;–&nbsp;3.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.372</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z WP</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.73&nbsp;–&nbsp;0.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.524</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z DBH</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.88&nbsp;–&nbsp;0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.570</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z LWC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.90&nbsp;–&nbsp;-0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.036</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z LDMC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.51&nbsp;–&nbsp;0.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.669</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z Height</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.46&nbsp;–&nbsp;1.56</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.286</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [linear]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.44&nbsp;–&nbsp;2.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.961</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [quadratic]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.84&nbsp;–&nbsp;2.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.734</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [cubic]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.56&nbsp;–&nbsp;5.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.015</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [4th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.83&nbsp;–&nbsp;-0.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.021</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [5th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.47&nbsp;–&nbsp;2.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.709</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [6th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.53&nbsp;–&nbsp;0.75</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.283</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [7th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.57&nbsp;–&nbsp;2.75</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.196</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [8th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.48&nbsp;–&nbsp;3.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.155</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [9th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.37&nbsp;–&nbsp;1.41</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.617</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [10th<br>degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.87</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.04&nbsp;–&nbsp;1.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.430</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [ABLA]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.82&nbsp;–&nbsp;3.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.533</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [JUMO]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.47&nbsp;–&nbsp;2.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.650</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [JUOS]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-6.68&nbsp;–&nbsp;-0.84</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.012</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIED]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.41&nbsp;–&nbsp;1.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.355</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PILE]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.22&nbsp;–&nbsp;6.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.322</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIPO]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.56&nbsp;–&nbsp;-1.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIPU]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.12&nbsp;–&nbsp;2.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.810</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIST]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.06&nbsp;–&nbsp;-0.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.016</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PSME]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.67&nbsp;–&nbsp;3.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.192</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [QUEM]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-6.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-9.68&nbsp;–&nbsp;-3.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [QUGA]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.07&nbsp;–&nbsp;1.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.644</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [QUHY]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.13&nbsp;–&nbsp;2.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.539</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.10</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>PLOT</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.44</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.44</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>PLOT</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">11</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">131</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.406 / 0.668</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare new (model with variance by species and plot) and old model (model without any variance structure)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(gls_2, M1.Tree_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Model df      AIC      BIC    logLik   Test  L.Ratio p-value
gls_2              1 29 553.9536 630.3607 -247.9768                        
M1.Tree_random     2 30 543.8564 622.8983 -241.9282 1 vs 2 12.09715   5e-04</code></pre>
</div>
</div>
<ol type="1">
<li>Check model selection</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(M1.nested)</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>lme2_ml <span class="ot">&lt;-</span> <span class="fu">update</span>(M1.Tree_random, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(lme2_ml, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Slope ~ z_WP + z_DBH + z_LWC + z_LDMC + z_Height + Stress_Level + 
    SP_CODE
             Df    AIC    LRT  Pr(&gt;Chi)    
&lt;none&gt;          573.07                     
z_WP          1 571.51  0.439   0.50756    
z_DBH         1 571.62  0.550   0.45841    
z_LWC         1 576.48  5.407   0.02006 *  
z_LDMC        1 571.27  0.195   0.65847    
z_Height      1 572.50  1.427   0.23220    
Stress_Level 10 577.22 24.147   0.00722 ** 
SP_CODE      12 613.83 64.757 3.023e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Refit with REML and validate</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co">#After selecting the optimal fixed structure, refit the model using REML for final coefficient estimates.</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>lme_final_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(M1.Tree_random, <span class="at">fixed =</span> Slope <span class="sc">~</span> z_LWC <span class="sc">+</span> Stress_Level <span class="sc">+</span> SP_CODE,</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lme_final_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: model_data 
     AIC      BIC  logLik
  534.68 604.1736 -241.34

Random effects:
 Formula: ~1 | PLOT
        (Intercept) Residual
StdDev:    1.479929 1.743637

Fixed effects:  Slope ~ z_LWC + Stress_Level + SP_CODE 
                    Value Std.Error DF   t-value p-value
(Intercept)      1.254866 0.9285367 97  1.351444  0.1797
z_LWC           -0.468199 0.2024155 97 -2.313058  0.0228
Stress_Level.L  -0.302639 1.1424828 97 -0.264896  0.7917
Stress_Level.Q  -0.454324 1.2017747 97 -0.378044  0.7062
Stress_Level.C   2.637033 1.0983781 97  2.400843  0.0183
Stress_Level^4  -2.364060 1.0697474 97 -2.209924  0.0295
Stress_Level^5   0.234177 0.8870403 97  0.263998  0.7923
Stress_Level^6  -0.926625 0.8173226 97 -1.133733  0.2597
Stress_Level^7   1.103694 0.8257853 97  1.336539  0.1845
Stress_Level^8   1.168107 0.8333791 97  1.401652  0.1642
Stress_Level^9  -0.507994 0.9287827 97 -0.546946  0.5857
Stress_Level^10 -0.926711 1.0753505 97 -0.861776  0.3909
SP_CODEABLA     -1.110201 2.1629193 97 -0.513288  0.6089
SP_CODEJUMO     -1.615583 1.4630821 97 -1.104232  0.2722
SP_CODEJUOS     -4.193166 1.1751061 97 -3.568330  0.0006
SP_CODEPIED     -2.345245 1.6495683 97 -1.421733  0.1583
SP_CODEPILE      1.717471 2.0788029 97  0.826183  0.4107
SP_CODEPIPO     -3.575095 0.9721682 97 -3.677444  0.0004
SP_CODEPIPU      0.194339 1.1639162 97  0.166970  0.8677
SP_CODEPIST     -2.809785 1.0672546 97 -2.632722  0.0099
SP_CODEPSME      1.493352 0.9575909 97  1.559489  0.1221
SP_CODEQUEM     -6.851260 1.4744113 97 -4.646777  0.0000
SP_CODEQUGA     -0.821759 1.1024813 97 -0.745372  0.4578
SP_CODEQUHY     -1.468432 1.3670485 97 -1.074162  0.2854
 Correlation: 
                (Intr) z_LWC  St_L.L St_L.Q St_L.C St_L^4 St_L^5 St_L^6 St_L^7
z_LWC           -0.028                                                        
Stress_Level.L  -0.188 -0.329                                                 
Stress_Level.Q   0.022  0.218 -0.620                                          
Stress_Level.C  -0.114 -0.275  0.415 -0.705                                   
Stress_Level^4   0.112  0.359 -0.475  0.294 -0.598                            
Stress_Level^5  -0.073 -0.322  0.446 -0.258  0.289 -0.616                     
Stress_Level^6  -0.088  0.162 -0.254  0.345 -0.238  0.109 -0.378              
Stress_Level^7  -0.035 -0.102  0.142 -0.249  0.179  0.049 -0.110 -0.314       
Stress_Level^8   0.041  0.056 -0.015 -0.028 -0.083  0.088  0.065 -0.122 -0.329
Stress_Level^9  -0.243 -0.071  0.075  0.127 -0.006 -0.200  0.204  0.106 -0.162
Stress_Level^10  0.103  0.026 -0.064 -0.065  0.010  0.077 -0.194  0.082  0.167
SP_CODEABLA     -0.102  0.090  0.093  0.041 -0.196  0.056  0.099 -0.121 -0.037
SP_CODEJUMO     -0.580  0.121 -0.089  0.019  0.028  0.059 -0.059  0.069  0.007
SP_CODEJUOS     -0.682  0.149 -0.059  0.136 -0.026  0.046 -0.083  0.158  0.068
SP_CODEPIED     -0.487  0.167 -0.109  0.029  0.012  0.077 -0.076  0.039 -0.043
SP_CODEPILE     -0.349 -0.189  0.176  0.197 -0.064 -0.287  0.350  0.113 -0.302
SP_CODEPIPO     -0.734  0.134 -0.044 -0.009  0.078 -0.003 -0.077  0.087  0.014
SP_CODEPIPU     -0.358 -0.069  0.063  0.078  0.017 -0.152  0.047  0.018 -0.043
SP_CODEPIST     -0.343  0.006 -0.017 -0.068 -0.001  0.025  0.028  0.074  0.012
SP_CODEPSME     -0.435  0.022 -0.017 -0.025  0.031 -0.027 -0.033  0.051  0.014
SP_CODEQUEM     -0.370  0.122  0.108 -0.037 -0.068  0.189 -0.192  0.300 -0.071
SP_CODEQUGA     -0.642  0.099 -0.108  0.065  0.038  0.090 -0.126  0.144  0.088
SP_CODEQUHY     -0.396  0.054 -0.032  0.012  0.048  0.051  0.002  0.112  0.066
                St_L^8 St_L^9 S_L^10 SP_CODEA SP_CODEJUM SP_CODEJUO SP_CODEPIE
z_LWC                                                                         
Stress_Level.L                                                                
Stress_Level.Q                                                                
Stress_Level.C                                                                
Stress_Level^4                                                                
Stress_Level^5                                                                
Stress_Level^6                                                                
Stress_Level^7                                                                
Stress_Level^8                                                                
Stress_Level^9  -0.221                                                        
Stress_Level^10 -0.160 -0.486                                                 
SP_CODEABLA      0.231 -0.207  0.182                                          
SP_CODEJUMO     -0.001  0.117 -0.030  0.045                                   
SP_CODEJUOS     -0.104  0.288 -0.150  0.020    0.431                          
SP_CODEPIED     -0.048  0.055 -0.028  0.037    0.795      0.362               
SP_CODEPILE      0.050  0.487 -0.475  0.012    0.129      0.290      0.089    
SP_CODEPIPO      0.037  0.174 -0.033  0.082    0.485      0.796      0.410    
SP_CODEPIPU      0.114  0.287 -0.145  0.229    0.196      0.287      0.136    
SP_CODEPIST     -0.005  0.073  0.024  0.201    0.236      0.295      0.194    
SP_CODEPSME     -0.045  0.024 -0.059  0.116    0.283      0.398      0.254    
SP_CODEQUEM      0.088 -0.013 -0.002  0.104    0.215      0.322      0.177    
SP_CODEQUGA     -0.118  0.210 -0.051 -0.001    0.430      0.677      0.363    
SP_CODEQUHY      0.041  0.112 -0.037  0.067    0.259      0.375      0.199    
                SP_CODEPIL SP_CODEPIPO SP_CODEPIPU SP_CODEPIS SP_CODEPS
z_LWC                                                                  
Stress_Level.L                                                         
Stress_Level.Q                                                         
Stress_Level.C                                                         
Stress_Level^4                                                         
Stress_Level^5                                                         
Stress_Level^6                                                         
Stress_Level^7                                                         
Stress_Level^8                                                         
Stress_Level^9                                                         
Stress_Level^10                                                        
SP_CODEABLA                                                            
SP_CODEJUMO                                                            
SP_CODEJUOS                                                            
SP_CODEPIED                                                            
SP_CODEPILE                                                            
SP_CODEPIPO      0.245                                                 
SP_CODEPIPU      0.303      0.319                                      
SP_CODEPIST      0.195      0.367       0.401                          
SP_CODEPSME      0.319      0.488       0.295       0.445              
SP_CODEQUEM      0.218      0.370       0.171       0.310      0.447   
SP_CODEQUGA      0.188      0.720       0.240       0.290      0.370   
SP_CODEQUHY      0.264      0.423       0.229       0.341      0.478   
                SP_CODEQUE SP_CODEQUG
z_LWC                                
Stress_Level.L                       
Stress_Level.Q                       
Stress_Level.C                       
Stress_Level^4                       
Stress_Level^5                       
Stress_Level^6                       
Stress_Level^7                       
Stress_Level^8                       
Stress_Level^9                       
Stress_Level^10                      
SP_CODEABLA                          
SP_CODEJUMO                          
SP_CODEJUOS                          
SP_CODEPIED                          
SP_CODEPILE                          
SP_CODEPIPO                          
SP_CODEPIPU                          
SP_CODEPIST                          
SP_CODEPSME                          
SP_CODEQUEM                          
SP_CODEQUGA      0.295               
SP_CODEQUHY      0.396      0.354    

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-2.715283428 -0.480497410 -0.003729176  0.495332890  2.857642912 

Number of Observations: 131
Number of Groups: 11 </code></pre>
</div>
</div>
<ol type="1">
<li>Figures</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(lme_final_2, <span class="at">show.se=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Slope</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Error</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.59&nbsp;–&nbsp;3.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.180</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">z LWC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.87&nbsp;–&nbsp;-0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.023</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [linear]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.57&nbsp;–&nbsp;1.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.792</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [quadratic]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.84&nbsp;–&nbsp;1.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.706</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [cubic]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.46&nbsp;–&nbsp;4.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.018</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [4th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.49&nbsp;–&nbsp;-0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.029</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [5th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.53&nbsp;–&nbsp;1.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.792</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [6th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.55&nbsp;–&nbsp;0.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.260</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [7th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.54&nbsp;–&nbsp;2.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.184</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [8th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.49&nbsp;–&nbsp;2.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.164</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [9th degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.35&nbsp;–&nbsp;1.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.586</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Stress Level [10th<br>degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.06&nbsp;–&nbsp;1.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.391</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [ABLA]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.40&nbsp;–&nbsp;3.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.609</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [JUMO]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.52&nbsp;–&nbsp;1.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.272</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [JUOS]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-6.53&nbsp;–&nbsp;-1.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIED]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.62&nbsp;–&nbsp;0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.158</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PILE]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.41&nbsp;–&nbsp;5.84</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.411</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIPO]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.50&nbsp;–&nbsp;-1.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIPU]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.12&nbsp;–&nbsp;2.50</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.868</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PIST]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.93&nbsp;–&nbsp;-0.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.010</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [PSME]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.41&nbsp;–&nbsp;3.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.122</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [QUEM]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-6.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-9.78&nbsp;–&nbsp;-3.92</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [QUGA]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.01&nbsp;–&nbsp;1.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.458</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SP CODE [QUHY]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.18&nbsp;–&nbsp;1.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.285</td>
</tr>
<tr>
<td colspan="5" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">3.04</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>PLOT</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">2.19</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.42</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>PLOT</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">11</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">131</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.409 / 0.656</td>
</tr>

</tbody></table>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stress Level range</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>stress <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients from your model</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fl">1.25</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>cubic_coef <span class="ot">&lt;-</span> <span class="fl">2.64</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>quartic_coef <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.36</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard errors for cubic + quartic (approximation)</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>cubic_se <span class="ot">&lt;-</span> <span class="fl">1.10</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>quartic_se <span class="ot">&lt;-</span> <span class="fl">1.07</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted Slope</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> intercept <span class="sc">+</span> cubic_coef <span class="sc">*</span> stress<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> quartic_coef <span class="sc">*</span> stress<span class="sc">^</span><span class="dv">4</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Approximate 95% CI using standard errors of the cubic + quartic terms</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> predicted <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(cubic_se<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> quartic_se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> predicted <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(cubic_se<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> quartic_se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for ggplot</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stress =</span> stress, <span class="at">predicted =</span> predicted,</span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ci_upper =</span> ci_upper, <span class="at">ci_lower =</span> ci_lower)</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> stress, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Stress Level (0 = dead, 10 = healthy)"</span>,</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Slope"</span>,</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Stress Level on Slope (3rd + 4th-degree)"</span></span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>)</span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LWC range (standardized, z-scores)</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll pick a reasonable range, e.g., -3 to +3 SD</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>lwc <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient and intercept</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fl">1.25</span>  <span class="co"># from your model</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>lwc_coef <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.47</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>lwc_se <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted Slope</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> intercept <span class="sc">+</span> lwc_coef <span class="sc">*</span> lwc</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% CI</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> predicted <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> lwc_se</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> predicted <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> lwc_se</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lwc =</span> lwc, <span class="at">predicted =</span> predicted,</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ci_upper =</span> ci_upper, <span class="at">ci_lower =</span> ci_lower)</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> lwc, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), <span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"z LWC (standardized leaf water content)"</span>,</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Slope"</span>,</span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of LWC on Slope"</span></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>)</span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with species effects</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ABLA"</span>,<span class="st">"JUMO"</span>,<span class="st">"JUOS"</span>,<span class="st">"PIED"</span>,<span class="st">"PILE"</span>,<span class="st">"PIPO"</span>,<span class="st">"PIPU"</span>,<span class="st">"PIST"</span>,<span class="st">"PSME"</span>,<span class="st">"QUEM"</span>,<span class="st">"QUGA"</span>,<span class="st">"QUHY"</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.11</span>,<span class="sc">-</span><span class="fl">1.62</span>,<span class="sc">-</span><span class="fl">4.19</span>,<span class="sc">-</span><span class="fl">2.35</span>,<span class="fl">1.72</span>,<span class="sc">-</span><span class="fl">3.58</span>,<span class="fl">0.19</span>,<span class="sc">-</span><span class="fl">2.81</span>,<span class="fl">1.49</span>,<span class="sc">-</span><span class="fl">6.85</span>,<span class="sc">-</span><span class="fl">0.82</span>,<span class="sc">-</span><span class="fl">1.47</span>)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.16</span>,<span class="fl">1.46</span>,<span class="fl">1.18</span>,<span class="fl">1.65</span>,<span class="fl">2.08</span>,<span class="fl">0.97</span>,<span class="fl">1.16</span>,<span class="fl">1.07</span>,<span class="fl">0.96</span>,<span class="fl">1.47</span>,<span class="fl">1.10</span>,<span class="fl">1.37</span>)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% CI</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> estimate <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> estimate <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify significance</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ci_lower <span class="sc">*</span> ci_upper <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(species, estimate, ci_lower, ci_upper, significant)</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder species by estimate for nicer plotting</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>species, <span class="at">levels =</span> df<span class="sc">$</span>species[<span class="fu">order</span>(df<span class="sc">$</span>estimate)])</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> species, <span class="at">color =</span> significant)) <span class="sc">+</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper), <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"pink"</span>, <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Effect on TWD Slope (Estimate ± 95% CI)"</span>,</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Species code"</span>,</span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Species Effects on TWD Slope"</span></span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>)</span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `geom_errobarh()` was deprecated in ggplot2 4.0.0.
ℹ Please use the `orientation` argument of `geom_errorbar()` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`height` was translated to `width`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">##model from model selection</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Check for assumption violations:</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">#- Homogeneity of residuals.</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">#- Normality.</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co">#- Outliers.</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lme_final_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lme_final_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting missing values (`NA`) into regular values currently not
  possible for variables of class `NULL`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment_2_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>